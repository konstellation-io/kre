apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-secrets
  labels:
    {{- include "kre.labels" . | nindent 4 }}
    app.kubernetes.io/instance: {{ .Release.Name }}
type: Opaque
data:
  KRE_MONGODB_ADDRESS: {{ include "runtime.mongoURI" . | b64enc }}
  KRE_AUTH_JWT_SIGN_SECRET: {{ .Values.config.auth.jwtSignSecret | b64enc }}
  {{- if .Values.config.smtp.enabled}}
  KRE_SMTP_USER: {{ .Values.config.smtp.user | b64enc }}
  KRE_SMTP_PASS: {{ .Values.config.smtp.pass | b64enc }}
  {{- end }}
  ## ApiToken
  KRE_AUTH_API_TOKEN_SECRET: "{{ .Values.config.auth.apiTokenSecret | b64enc }}"

  # Monoruntime config
  MONORUNTIME_MONGO_USERNAME: {{ .Values.mongodb.auth.adminUser | b64enc }}
  MONORUNTIME_MONGO_PASSWORD: {{ .Values.mongodb.auth.adminPassword | b64enc }}

  # Runtime config
  KRE_RUNTIME_MONGO_URI: {{ include "runtime.mongoURI" . | b64enc }}
